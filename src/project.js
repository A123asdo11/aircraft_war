require=function e(t,o,n){function i(c,a){if(!o[c]){if(!t[c]){var r="function"==typeof require&&require;if(!a&&r)return r(c,!0);if(s)return s(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var l=o[c]={exports:{}};t[c][0].call(l.exports,function(e){var o=t[c][1][e];return i(o?o:e)},l,l.exports,e,t,o,n)}return o[c].exports}for(var s="function"==typeof require&&require,c=0;c<n.length;c++)i(n[c]);return i}({bulletGroup:[function(require,module,exports){"use strict";cc._RFpush(module,"3d2d93zegRMeaoaPHxucDMn","bulletGroup");var bPosition=cc.Class({name:"bPosition",properties:{xAxis:{"default":"",tooltip:"初始x轴，相对hero"},yAxis:{"default":"",tooltip:"初始y轴，相对hero"}}}),bulletInfinite=cc.Class({name:"bulletInfinite",properties:{name:"",freqTime:0,initPollCount:0,prefab:cc.Prefab,position:{"default":[],type:bPosition,tooltip:"每次多少排子弹"}}}),bulletFiniteG=cc.Class({name:"bulletFiniteG","extends":bulletInfinite,properties:{finiteTime:0,orginName:""}});cc.Class({"extends":cc.Component,properties:function(){return{bulletInfinite:{"default":null,type:bulletInfinite,tooltip:"无限时长子弹组"},bulletFiniteG:{"default":[],type:bulletFiniteG,tooltip:"有限时长子弹组"},hero:cc.Node}},onLoad:function(){this.eState=D.commonInfo.gameState.none,D.common.initObjPool(this,this.bulletInfinite),D.common.batchInitObjPool(this,this.bulletFiniteG)},startAction:function(){this.eState=D.commonInfo.gameState.start,this.getNewbullet(this.bulletInfinite),this.bICallback=function(){this.getNewbullet(this.bulletInfinite)}.bind(this),this.schedule(this.bICallback,this.bulletInfinite.freqTime)},pauseAction:function(){this.enabled=!1,this.eState=D.commonInfo.gameState.pause},resumeAction:function(){this.enabled=!0,this.eState=D.commonInfo.gameState.start},changeBullet:function(e){this.unschedule(this.bICallback),this.unschedule(this.bFCallback);for(var t=0;t<this.bulletFiniteG.length;t++)if(this.bulletFiniteG[t].orginName==e){this.bFCallback=function(e){this.getNewbullet(this.bulletFiniteG[e])}.bind(this,t),this.schedule(this.bFCallback,this.bulletFiniteG[t].freqTime,this.bulletFiniteG[t].finiteTime);var o=this.bulletFiniteG[t].freqTime*this.bulletFiniteG[t].finiteTime;this.schedule(this.bICallback,this.bulletInfinite.freqTime,cc.macro.REPEAT_FOREVER,o)}},getNewbullet:function(e){for(var t=e.name+"Pool",o=0;o<e.position.length;o++){var n=D.common.genNewNode(this[t],e.prefab,this.node),i=this.getBulletPostion(e.position[o]);n.setPosition(i),n.getComponent("bullet").bulletGroup=this}},getBulletPostion:function getBulletPostion(posInfo){var hPos=this.hero.getPosition(),newV2_x=hPos.x+eval(posInfo.xAxis),newV2_y=hPos.y+eval(posInfo.yAxis);return cc.p(newV2_x,newV2_y)},bulletDied:function(e){D.common.backObjPool(this,e)}}),cc._RFpop()},{}],bullet:[function(e,t,o){"use strict";cc._RFpush(t,"81be82YwS9L1LZYufVXSrCP","bullet"),cc.Class({"extends":cc.Component,properties:{xSpeed:cc.Integer,ySpeed:cc.Integer,hpDrop:cc.Integer},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(e,t){this.bulletGroup.bulletDied(t.node)},update:function(e){this.bulletGroup.eState==D.commonInfo.gameState.start&&(this.node.x+=e*this.xSpeed,this.node.y+=e*this.ySpeed,this.node.y>this.node.parent.height&&this.bulletGroup.bulletDied(this.node))}}),cc._RFpop()},{}],common:[function(e,t,o){"use strict";cc._RFpush(t,"67917VzMgFG4LdHbqjwaGkY","common");var n=cc.Enum({none:0,start:1,stop:2}),i=cc.Class({"extends":cc.Component,properties:{},statics:{gameState:n},onLoad:function(){D.commonInfo=i,D.common=this},batchInitObjPool:function(e,t){for(var o=0;o<t.length;o++){var n=t[o];this.initObjPool(e,n)}},initObjPool:function(e,t){var o=t.name,n=o+"Pool";e[n]=new cc.NodePool;for(var i=t.initPollCount,s=0;s<i;++s){var c=cc.instantiate(t.prefab);e[n].put(c)}},genNewNode:function(e,t,o){var n=null;return n=e.size()>0?e.get():cc.instantiate(t),o.addChild(n),n},backObjPool:function(e,t){var o=t.name+"Pool";e[o].put(t)},timeFmt:function(e,t){var o={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in o)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?o[n]:("00"+o[n]).substr((""+o[n]).length)));return t}});cc._RFpop()},{}],end:[function(e,t,o){"use strict";cc._RFpush(t,"c597br4kitB+7t22tMQBl2k","end"),cc.Class({"extends":cc.Component,properties:{topScore:cc.Label,currentScore:cc.Label},onLoad:function(){var e=cc.sys.localStorage.getItem("topScore");this.topScore.string=e;var t=cc.sys.localStorage.getItem("currentScore");this.currentScore.string=t,cc.director.preloadScene("historyScore")},gameRestart:function(){cc.director.loadScene("main")},gameExit:function(){cc.director.loadScene("start")},gotoHistoryScore:function(){cc.director.loadScene("historyScore")}}),cc._RFpop()},{}],enemyGroup:[function(e,t,o){"use strict";cc._RFpush(t,"703caNdSJBMG5jxYvPFwWvP","enemyGroup");var n=cc.Class({name:"enemyG",properties:{name:"",freqTime:0,initPollCount:0,prefab:cc.Prefab}});cc.Class({"extends":cc.Component,properties:function(){return{enemyG:{"default":[],type:n},main:{"default":null,type:e("main")}}},onLoad:function(){this.eState=D.commonInfo.gameState.none,D.common.batchInitObjPool(this,this.enemyG)},startAction:function(){this.eState=D.commonInfo.gameState.start;for(var e=0;e<this.enemyG.length;++e){var t=this.enemyG[e].freqTime,o="callback_"+e;this[o]=function(e){this.getNewEnemy(this.enemyG[e])}.bind(this,e),this.schedule(this[o],t)}},resumeAction:function(){this.enabled=!0,this.eState=D.commonInfo.gameState.start},pauseAction:function(){this.enabled=!1,this.eState=D.commonInfo.gameState.pause},getNewEnemy:function(e){var t=e.name+"Pool",o=D.common.genNewNode(this[t],e.prefab,this.node),n=this.getNewEnemyPositon(o);o.setPosition(n),o.getComponent("enemy").init()},getNewEnemyPositon:function(e){var t=cc.randomMinus1To1()*(this.node.parent.width/2-e.width/2),o=this.node.parent.height/2+e.height/2;return cc.v2(t,o)},enemyDied:function(e,t){D.common.backObjPool(this,e),parseInt(t)>0&&this.main.gainScore(t)},getScore:function(){return this.main.getScore()}}),cc._RFpop()},{main:"main"}],enemy:[function(e,t,o){"use strict";cc._RFpush(t,"14abee9CoxCobWl/nmeEUv8","enemy"),cc.Class({"extends":cc.Component,properties:{xMinSpeed:{"default":0,type:cc.Integer,tooltip:"x轴最小速度"},xMaxSpeed:{"default":0,type:cc.Integer,tooltip:"x轴最大速度"},yMinSpeed:{"default":0,type:cc.Integer,tooltip:"y轴最小速度"},yMaxSpeed:{"default":0,type:cc.Integer,tooltip:"y轴最大速度"},initHP:{"default":0,type:cc.Integer,tooltip:"初始生命值"},initSpriteFrame:{"default":null,type:cc.SpriteFrame,tooltip:"初始化的图像"},score:{"default":0,type:cc.Integer,tooltip:"死后获得的分数"},enemyDownClip:cc.AudioClip},onLoad:function(){console.log("enemy onload"),cc.director.getCollisionManager().enabled=!0,this.xSpeed=Math.random()*(this.xMaxSpeed-this.xMinSpeed)+this.xMinSpeed,this.ySpeed=cc.random0To1()*(this.yMaxSpeed-this.yMinSpeed)+this.yMinSpeed,this.enemyGroup=this.node.parent.getComponent("enemyGroup")},init:function(){"enemy"!=this.node.group&&(this.node.group="enemy"),this.hP!=this.initHP&&(this.hP=this.initHP);var e=this.node.getComponent(cc.Sprite);e.spriteFrame!=this.initSpriteFrame&&(e.spriteFrame=this.initSpriteFrame)},update:function(e){if(this.enemyGroup.eState==D.commonInfo.gameState.start){var t=this.enemyGroup.getScore();t<=5e4?this.node.y+=e*this.ySpeed:t>5e4&&t<=1e5?this.node.y+=e*this.ySpeed-.5:t>1e5&&t<=15e4?this.node.y+=e*this.ySpeed-1:t>15e4&&t<=2e5?this.node.y+=e*this.ySpeed-1.5:t>2e5&&t<=3e5?this.node.y+=e*this.ySpeed-2:this.node.y+=e*this.ySpeed-3,this.node.x+=e*this.xSpeed,this.node.y<-this.node.parent.height/2&&this.enemyGroup.enemyDied(this.node,0)}},onCollisionEnter:function(e,t){if("bullet"==e.node.group){var o=e.node.getComponent("bullet");if(this.hP>0&&(this.hP-=o.hpDrop,this.hP<=0)){this.node.group="default";var n=this.getComponent(cc.Animation),i=t.node.name+"ani";n.play(i),n.on("finished",this.onFinished,this),cc.audioEngine.playEffect(this.enemyDownClip,!1)}}},onFinished:function(e){this.enemyGroup.enemyDied(this.node,this.score)}}),cc._RFpop()},{}],globals:[function(e,t,o){"use strict";cc._RFpush(t,"2db22ldw1ZEWKAUUhqzblk7","globals"),window.D={common:null,commonInfo:null},cc._RFpop()},{}],hero:[function(e,t,o){"use strict";cc._RFpush(t,"3f0ccHUefxOLK9+K5/zp2v4","hero"),cc.Class({"extends":cc.Component,properties:function(){return{blowupani:{"default":null,type:cc.Prefab,tooltip:"爆炸动画"},gameOverClip:cc.AudioClip,main:{"default":null,type:e("main")},bulletGroup:{"default":null,type:e("bulletGroup")}}},onLoad:function(){this.eState=D.commonInfo.gameState.none,cc.director.getCollisionManager().enabled=!0,this.onDrag()},onDrag:function(){this.node.on("touchmove",this.dragMove,this)},offDrag:function(){this.node.off("touchmove",this.dragMove,this)},dragMove:function(e){var t=e.getLocation(),o=this.node.parent.convertToNodeSpaceAR(t),n=-this.node.parent.width/2+this.node.width/2,i=-n,s=-this.node.parent.height/2+this.node.height/2,c=-s;o.x<n&&(o.x=n),o.x>i&&(o.x=i),o.y<s&&(o.y=s),o.y>c&&(o.y=c),this.node.setPosition(o)},onCollisionEnter:function(e,t){if("ufo"==e.node.group)"ufoBullet"==e.node.name?this.bulletGroup.changeBullet(e.node.name):"ufoBomb"==e.node.name&&this.main.getUfoBomb();else{if("enemy"!=e.node.group)return!1;var o=this.node.getPosition(),n=cc.instantiate(this.blowupani);this.node.parent.addChild(n),n.setPosition(o);var i=n.getComponent(cc.Animation);i.on("finished",this.onFinished,n),cc.audioEngine.playEffect(this.gameOverClip,!1),this.node.destroy(),this.main.gameOver()}},onFinished:function(e){this.destroy()}}),cc._RFpop()},{bulletGroup:"bulletGroup",main:"main"}],historyScore:[function(e,t,o){"use strict";cc._RFpush(t,"c11abrWZANO2aVZSE4dxEvW","historyScore"),cc.Class({"extends":cc.Component,properties:{itemPrefab:cc.Prefab,scrollContent:cc.Node,backGame:cc.Node},onLoad:function(){for(var e=JSON.parse(cc.sys.localStorage.getItem("score")),t=0;t<e.length;++t){var o=cc.instantiate(this.itemPrefab),n=e[t];this.scrollContent.addChild(o),o.getComponent("scoreItemTemplate").init({score:n.score,time:n.time})}this.backGame.on("touchstart",this.backGameO,this)},backGameO:function(){cc.director.loadScene("end")}}),cc._RFpop()},{}],main:[function(e,t,o){"use strict";cc._RFpush(t,"6afa0phF7dPka/zlZtFFHow","main"),cc.Class({"extends":cc.Component,properties:function(){return{pause:cc.Button,btnSprite:{"default":[],type:cc.SpriteFrame,tooltip:"暂停按钮不同状态的图片"},bomb:cc.Node,gameMusic:{"default":null,type:cc.AudioSource},useBombClip:cc.AudioClip,enemyGroup:{"default":null,type:e("enemyGroup")},hero:{"default":null,type:e("hero")},ufoGroup:{"default":null,type:e("ufoGroup")},bulletGroup:{"default":null,type:e("bulletGroup")},scoreDisplay:cc.Label,bombNoDisplay:cc.Label}},onLoad:function(){this.score=0,this.bombNo=0,this.scoreDisplay.string=this.score,this.bombNoDisplay.string=this.bombNo,this.eState=D.commonInfo.gameState.start,this.enemyGroup.startAction(),this.bulletGroup.startAction(),this.ufoGroup.startAction(),this.bomb.on("touchstart",this.bombOnclick,this),this.gameMusic.play()},bombOnclick:function(){var e=this.bomb.getChildByName("bombNo").getComponent(cc.Label),t=parseInt(e.string);t>0?(e.string=t-1,this.removeEnemy(),cc.audioEngine.playEffect(this.useBombClip,!1)):console.log("没有子弹")},pauseClick:function(){this.eState==D.commonInfo.gameState.pause?(this.resumeAction(),this.eState=D.commonInfo.gameState.start):this.eState==D.commonInfo.gameState.start&&(this.pauseAction(),this.eState=D.commonInfo.gameState.pause)},resumeAction:function(){this.enemyGroup.resumeAction(),this.bulletGroup.resumeAction(),this.ufoGroup.resumeAction(),this.hero.onDrag(),this.gameMusic.resume(),this.pause.normalSprite=this.btnSprite[0],this.pause.pressedSprite=this.btnSprite[1],this.pause.hoverSprite=this.btnSprite[1]},pauseAction:function(){this.enemyGroup.pauseAction(),this.bulletGroup.pauseAction(),this.hero.offDrag(),this.gameMusic.pause(),this.ufoGroup.pauseAction(),this.pause.normalSprite=this.btnSprite[2],this.pause.pressedSprite=this.btnSprite[3],this.pause.hoverSprite=this.btnSprite[3]},gainScore:function(e){this.score+=e,this.scoreDisplay.string=this.score.toString()},getScore:function(){return parseInt(this.scoreDisplay.string)},updateScore:function(){var e=this.scoreDisplay.string,t={score:e,time:D.common.timeFmt(new Date,"yyyy-MM-dd hh:mm:ss")},o=cc.sys.localStorage.getItem("score"),n=cc.sys.localStorage.getItem("topScore");(!n||parseInt(n)<parseInt(e))&&cc.sys.localStorage.setItem("topScore",e),o?(o=JSON.parse(o),o.unshift(t)):(o=[],o.unshift(t)),cc.sys.localStorage.setItem("currentScore",e),cc.sys.localStorage.setItem("score",JSON.stringify(o))},removeEnemy:function(){this.enemyGroup.node.removeAllChildren()},getUfoBomb:function(){parseInt(this.bombNoDisplay.string)<3&&(this.bombNoDisplay.string+=1)},gameOver:function(){this.pauseAction(),this.updateScore(),cc.director.loadScene("end")}}),cc._RFpop()},{bulletGroup:"bulletGroup",enemyGroup:"enemyGroup",hero:"hero",ufoGroup:"ufoGroup"}],scoreItemTemplate:[function(e,t,o){"use strict";cc._RFpush(t,"e7aaajpGBdAAaGaUimU4MnH","scoreItemTemplate"),cc.Class({"extends":cc.Component,properties:{itemScore:cc.Label,itemTime:cc.Label},onLoad:function(){},init:function(e){this.itemScore.string="积分："+e.score,this.itemTime.string="时间："+e.time}}),cc._RFpop()},{}],start:[function(e,t,o){"use strict";cc._RFpush(t,"280c3rsZJJKnZ9RqbALVwtK","start"),cc.Class({"extends":cc.Component,properties:{game_loading:cc.Node},onLoad:function(){var e=this.game_loading.getComponent(cc.Animation);e.play(),cc.director.preloadScene("main")},startGame:function(){cc.director.loadScene("main",function(){console.log("main is loaded")})}}),cc._RFpop()},{}],ufoGroup:[function(e,t,o){"use strict";cc._RFpush(t,"07c58NeAQVELrP3L2RCOyrA","ufoGroup");var n=cc.Class({name:"ufoG",properties:{name:"",freqTime:0,prefab:cc.Prefab,initPoolCount:0,minDelay:{"default":0,tooltip:"最小延迟"},maxDelay:{"default":0,tooltip:"最大延迟"}}});cc.Class({"extends":cc.Component,properties:{ufoG:{"default":[],type:n}},onLoad:function(){this.eState=D.commonInfo.gameState.none,D.common.batchInitObjPool(this,this.ufoG)},startAction:function(){this.eState=D.commonInfo.gameState.start;for(var e=0;e<this.ufoG.length;++e){var t=this.ufoG[e].freqTime,o="callback_"+e;this[o]=function(e){this.randNewUfo(this.ufoG[e])}.bind(this,e),this.schedule(this[o],t)}},randNewUfo:function(e){var t=Math.random()*(e.maxDelay-e.minDelay)+e.minDelay;this.scheduleOnce(function(e){this.getNewUfo(e)}.bind(this,e),t)},getNewUfo:function(e){var t=e.name+"Pool",o=D.common.genNewNode(this[t],e.prefab,this.node),n=this.getNewUfoPositon(o);o.setPosition(n)},getNewUfoPositon:function(e){var t=cc.randomMinus1To1()*(this.node.parent.width/2-e.width/2),o=this.node.parent.height/2+e.height/2;return cc.v2(t,o)},resumeAction:function(){this.enabled=!0,this.eState=D.commonInfo.gameState.start},pauseAction:function(){this.enabled=!1,this.eState=D.commonInfo.gameState.pause},ufoDied:function(e){D.common.backObjPool(this,e)}}),cc._RFpop()},{}],ufo:[function(e,t,o){"use strict";cc._RFpush(t,"1e7a0zfIuJA+Kn9DAfY5544","ufo"),cc.Class({"extends":cc.Component,properties:{xMinSpeed:{"default":0,type:cc.Integer},xMaxSpeed:{"default":0,type:cc.Integer},yMinSpeed:{"default":0,type:cc.Integer},yMaxSpeed:{"default":0,type:cc.Integer},getUfoClip:cc.AudioClip},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.xSpeed=Math.random()*(this.xMaxSpeed-this.xMinSpeed)+this.xMinSpeed,this.ySpeed=cc.random0To1()*(this.yMaxSpeed-this.yMinSpeed)+this.yMinSpeed,this.ufoGroup=this.node.parent.getComponent("ufoGroup")},onCollisionEnter:function(e,t){this.node.destroy(),cc.audioEngine.playEffect(this.getUfoClip,!1)},update:function(e){this.ufoGroup.eState==D.commonInfo.gameState.start&&(this.node.x+=e*this.xSpeed,this.node.y+=e*this.ySpeed,this.node.y<-this.node.parent.height/2&&this.ufoGroup.ufoDied(this.node))}}),cc._RFpop()},{}]},{},["ufoGroup","enemy","ufo","start","bulletGroup","globals","hero","main","enemyGroup","bullet","common","historyScore","end","scoreItemTemplate"]);